package com.sbz;
import com.sbz.proj.model.*;

import java.util.List;

global java.util.logging.Logger LOGGER



rule "Call with high cards"
	lock-on-active true
	agenda-group "pre-flop"
	when
        $state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank != $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank >= 25,
							$player.getAction.get(0) == Action.NONE,
							$players : players
							)
		Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players
		accumulate( Player($pot : getMoney()) from $players, $maxMoney : max($pot))
		Player(moneyRatio($maxMoney.doubleValue()) <= 2) from $player
    then
        modify($state) { getPlayers().get(0).getAction().set(0, Action.CALL) }
		insert(Action.CALL);
		delete($state);
        System.out.println("You should call to "+ $maxMoney);
end


rule "Backing off from raise with high cards"
	lock-on-active true
	agenda-group "pre-flop"
	when
		$state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank != $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank >= 25,
							$players : players
							)
		Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players
		accumulate( Player($pot : getMoney()) from $players, $maxMoney : max($pot))
		Player(moneyRatio($maxMoney.doubleValue()) > 2) from $player
	then
		modify($state) { getPlayers().get(0).getAction().set(0, Action.FOLD) }
		insert(Action.FOLD);
		delete($state);
        System.out.println("You should fold");
end


rule "Raise with high cards"
    lock-on-active true
	agenda-group "pre-flop"
	when
        $state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank != $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank >= 25,
							$players : players
							)
		not(Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players)
    then
        modify($state) { getPlayers().get(0).getAction().set(0, Action.RAISE) }
		insert(Action.RAISE);
		delete($state);
        System.out.println("You should raise");
end


rule "Backing off from raise with low cards"
	lock-on-active true
	agenda-group "pre-flop"
	when
		$state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank != $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + 5 < $player.getCard2().rank.rank,
							$player.getCard1().suit.rank != $player.getCard2().suit.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank < 11,
							$players : players
							)
		Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players		
	then
		modify($state) { getPlayers().get(0).getAction().set(0, Action.FOLD) }
		insert(Action.FOLD);
		delete($state);
        System.out.println("You should fold");
end


rule "Raising with good pocket pair"
	lock-on-active true
	agenda-group "pre-flop"
    when
		$state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank == $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank >= 18
							)
	then
		modify($state) { getPlayers().get(0).getAction().set(0, Action.RAISE) }
		insert(Action.RAISE);
		delete($state);
        System.out.println("You should raise");
end


rule "Raising with lower pocket pair"
	lock-on-active true
	agenda-group "pre-flop"
    when
		$state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank == $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank < 18,
							$players : players
							)
		not(Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players)
	then
		modify($state) { getPlayers().get(0).getAction().set(0, Action.RAISE) }
		insert(Action.RAISE);
		delete($state);
        System.out.println("You should raise");
end

rule "Call with mediocre cards"
	lock-on-active true
	agenda-group "pre-flop"
	when
		$state : TableState(
							$player : players.get(0),
							$player.getCard1().rank.rank != $player.getCard2().rank.rank,
							$player.getCard1().rank.rank + $player.getCard2().rank.rank < 12,
							$players : players
							)
		not(Player(getAction().get(0) == Action.RAISE || getAction().get(0) == Action.BET) from $players)
	then
		modify($state) { getPlayers().get(0).getAction().set(0, Action.CALL) }
		insert(Action.CALL);
		delete($state);
        System.out.println("You should call to big blind");
end
